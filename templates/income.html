{% extends "layout.html" %}
{% block title %}Income Details{% endblock %}
{% block content %}
<div class="content-card">
    
    <h2>Income Details</h2>
    <p>First, let's get a picture of your monthly income.</p>

    <form action="{{ url_for('income') }}" method="post" style="margin-top: 2rem;">
        
        <div class="form-row">
            <div class="form-group" style="flex: 2;"> <!-- Make this field wider -->
                <label for="monthly_income">Primary Monthly Income</label>
                <input type="number" step="0.01" id="monthly_income" name="monthly_income" placeholder="e.g., 50000" required>
            </div>
            <div class="form-group" style="flex: 1;">
                <label for="currency">Currency</label>
                <select id="currency" name="currency" required>
                    <option value="INR">₹ INR</option>
                    <option value="USD">$ USD</option>
                    <option value="EUR">€ EUR</option>
                    <option value="GBP">£ GBP</option>
                </select>
            </div>
        </div>

        <h3 style="text-align: left; margin-top: 2rem; border-top: 1px solid #eee; padding-top: 1.5rem;">Other Income Sources (Optional)</h3>
        
        <div id="other-sources-container">
            <!-- Dynamic rows will be added here -->
        </div>

        <!-- "Add Source" button styled to be less prominent -->
        <button type="button" id="add-source-btn" style="background: none; border: none; color: #DAA520; cursor: pointer; padding: 0.5rem 0; font-weight: 600;">
            + Add Another Source
        </button>

        <!-- Main form actions at the bottom -->
        <div style="text-align: right; margin-top: 2.5rem; border-top: 1px solid #eee; padding-top: 1.5rem;">
            <button type="submit" name="next" class="btn btn-primary">Save and Continue</button>
        </div>
    </form>
</div>

<script>
    // Function to create a new income source row
    function createNewSourceRow() {
        const container = document.getElementById('other-sources-container');
        const newSourceRow = document.createElement('div');
        newSourceRow.classList.add('form-row');
        newSourceRow.style.marginBottom = '1rem';
        newSourceRow.innerHTML = `
            <div class="form-group" style="flex: 2;">
                <label for="source_name">Source Name</label>
                <input type="text" name="source_name[]" placeholder="e.g., Freelance Project">
            </div>
            <div class="form-group" style="flex: 1;">
                <label for="source_amount">Amount</label>
                <input type="number" step="0.01" name="source_amount[]" placeholder="e.g., 5000">
            </div>
        `;
        container.appendChild(newSourceRow);
    }

    // Add one row initially when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        createNewSourceRow();
    });

    // Add another row when the button is clicked
    document.getElementById('add-source-btn').addEventListener('click', createNewSourceRow);
</script>
{% endblock %}